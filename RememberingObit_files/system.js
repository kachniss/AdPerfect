$.fn.extend({toHTMLString:function(){return $("<div>").append(this.clone()).html();}});function is_scalar(a){return($.inArray(typeof a,["string","number","boolean"])!==-1);}function compare_object(b,a){var c=true;if(Object.keys(b).length!=Object.keys(a).length){return false;}$.each(b,function(f,e){if(!(f in a)){c=false;return false;}var d=a[f];if(e!=d){if(is_scalar(e)&&is_scalar(d)){c=false;return false;}else{if(e==null||d==null){c=false;return false;}else{if(!compare_object(e,d)){c=false;return false;}}}}});return c;}function init_login_popup(){var a=230;if(wp.fb_req==1){a+=50;}var b=i18n.T("signin_popup_js_btn_cancel",{signin_popup_js_btn_cancel:"Cancel"});var c={};c[b]=function(){$("#ap-login-popup").dialog("close");};$("#ap-login-popup").dialog({title:false,height:a,width:400,resizable:false,autoOpen:false,draggable:false,modal:true,buttons:c});}function encode64(d){var b="";var l,j,g="";var k,h,f,e="";var c=0;var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";do{l=d.charCodeAt(c++);j=d.charCodeAt(c++);g=d.charCodeAt(c++);k=l>>2;h=((l&3)<<4)|(j>>4);f=((j&15)<<2)|(g>>6);e=g&63;if(isNaN(j)){f=e=64;}else{if(isNaN(g)){e=64;}}b=b+a.charAt(k)+a.charAt(h)+a.charAt(f)+a.charAt(e);l=j=g="";k=h=f=e="";}while(c<d.length);return b;}function require_login(e,d,f){if(wp.auth==1){if(typeof e==="function"){e();}}else{if(wp.clp==1){$("body").triggerHandler("pre_login");}else{var c="http://"+location.host+location.pathname+location.search;var a=d||c;if(typeof f!=="undefined"&&f!==null&&f!==""){a=append_pending_searchagent_watch_to_next_url(a,f);}var b=encode64(a);var g="http://"+wp.login_host+wp.signin_href;location.href=g+"?next="+b;}}return false;}function show_old_facebook_login(d,h,c,e){var b=$("#ap-login-popup");if(typeof h=="undefined"){b.prev().hide();}else{if(c!=""&&typeof(c)!="undefined"){h=c;}b.prev().find("span.ui-dialog-title").html(h);}var a;if(typeof d==="string"){a=encode64(d);wp.login_href=d;}else{if(wp.login_href){a=encode64(wp.login_href);}else{var g=window.location.href;a=encode64(g);wp.login_href=g;}}var f="http://"+wp.login_host+wp.signin_href;b.find("a.ap_std_login").attr("href",f+"?next="+a);if(typeof(e)!="undefined"){b.find("div.ap-login-popup-description").html(e);}b.dialog("open");return false;}function append_pending_searchagent_watch_to_next_url(a,c){var b=a.replace(/((pending_watch|pending_searchagent)=[^&]*&?)/g,"");b=b.replace(/[&\?]$/,"");if(b.trim()!==""){if(b.indexOf("?")!==-1){b+="&"+c;}else{b+="?"+c;}}return b;}function message(a){if(typeof(wp.message)=="function"){wp.message(a);}else{if(typeof(mod_message_show)=="function"){if(wp.message_duration){duration=wp.message_duration;}else{duration=3000;}mod_message_show(a,duration);}else{if(wp.alerts==1){alert(a);}}}return false;}function get_search(){var b=window.location.search.substr(1);var a=b.split("&");var c={};$.each(a,function(d,e){var f=e.split("=");c[f[0]]=f[1];});return c;}function compile_search(b){var a=[];$.each(b,function(c,d){if(!c){return;}a.push(c+"="+encodeURIComponent(d));});return"?"+a.join("&");}function update_url(c,e){e=e||[];if(!window.history.replaceState){return;}var b=get_search();$.each(e,function(f,g){delete b[g];});$.extend(b,c);var d=compile_search(b);var a=location.protocol+"//"+location.hostname+location.pathname+d;if(a!=window.location){window.history.replaceState({path:a},"",a);}}function deep_copy(a){return $.extend(true,{},a);}function dict_merge(c,b){var a={};if(!b){b={};}$.each([c,b],function(d,e){$.each(e,function(f,g){a[f]=g;});});return a;}function get_form_elements(a){var b={};a.find("input, select, textarea").each(function(){b[$(this).attr("name")]=$(this).val();});return b;}function get_storage_host(){var b=wp.storage_hosts.length;var a=Math.floor(Math.random()*b);return document.location.protocol+"//"+wp.storage_hosts[a];}function get_cookie_data(a){var c=document.cookie.split(";");var b=tmp=val=null;for(b=0;b<c.length;b++){tmp=c[b].split("=");if(tmp[0].trim()==a){val=tmp[1].trim();break;}}return val;}function get_geodata(){var x=get_cookie_data("wp_geodata");if(!x){return{};}return eval("("+decodeURIComponent(x)+")");}if(!Array.indexOf){Array.prototype.indexOf=function(b){for(var a=0;a<this.length;a++){if(this[a]==b){return a;}}return -1;};}if(!Object.keys){Object.keys=function(c){if(c!==Object(c)){throw new TypeError("Object.keys called on non-object");}var a=[],b;for(b in c){if(Object.prototype.hasOwnProperty.call(c,b)){a.push(b);}}return a;};}function get_advanced_search_updated_url(b,f,e){if(typeof b==="undefined"){b=null;}if(typeof f==="undefined"){f=true;}if(typeof f==="undefined"){e=false;}var c=location.protocol+"//"+location.hostname+location.pathname;var a="";if(f&&is_advanced_search_metafilter_changed()){a="&search_mode=search";}var d=$("#ap_advanced_search_form").serialize()+a;b=$.extend({},b);$.each(b,function(g,h){d+="&"+g+"="+h;});if(e){return d;}return c+"?"+d;}function is_advanced_search_metafilter_changed(){if(typeof mod.advs==="undefined"||!mod.advs.meta_filter_js){return false;}var a=false;var d=$("#ap_advanced_search_form").serializeArray();var c=mod.advs.meta_filter_js;var b={};var e={};$.each(c,function(f,g){if(typeof g==="object"&&!$.isEmptyObject(g)){b[f]=Object.keys(g).length;}});$.each(d,function(h,f){var g=f.name;var j=f.value;if(g in c){if(j.trim()==c[g]||(!c[g]&&j==="_noval")){}else{a=true;return false;}}else{var i=g.match(/(.*)\[(.*?)\]/);if(i!==null){var l=i[1];var k=i[2];if(l in c){if(k in c[l]){e[l]=e[l]?e[l]+1:1;}else{a=true;return false;}}}}});if(!a){$.each(b,function(f,g){if(!(f in e)||e[f]!=g){a=true;return false;}});}return a;}function show_centralized_system_message(b,a){if(typeof mod_system_message==="undefined"||mod.system_message.centralized_system_msg!=1){return false;}mod_system_message.display_message(b,a);return true;}function hide_centralized_system_message(){if(typeof mod_system_message==="undefined"||mod.system_message.centralized_system_msg!=1){return false;}mod_system_message.clear_time_out();mod_system_message.system_msg_content.html("");mod_system_message.system_msg_container.hide();return true;}function scroll_to_element(c,b,a){c=$(c);if(c.length===0){return;}if(!$.isNumeric(a)){a=$(".navbar-static-top, .navbar-fixed-top").first().outerHeight(true)||0;}a=Math.abs((a));c=$(c).first();var d=c.offset();$("html,body").animate({scrollTop:d.top-a},b);}function get_query_value(b){var a=decodeURIComponent(window.location.search.substring(1));var c=a.split("&");var e=null;var d;$.each(c,function(f,g){d=g.match(/^([^=]+)=(.*)$/);if(!d){return;}if(d[1]===b){e=d[2]===""?null:d[2];return false;}});return e;}function is_valid_date(b,c,a){if(!$.isNumeric(b)){return false;}c=$.trim(c);a=$.trim(a);if(c===""&&a===""){return true;}if(!$.isNumeric(c)||c>12||c<1){return false;}if(a===""){return true;}if(!$.isNumeric(a)||a>31||a<1){return false;}c--;var e=new Date(b,c,a);return e.getFullYear()==b&&e.getMonth()==c&&e.getDate()==a;}function append_url_segment(e,b,h){if(typeof b==="undefined"){b=location.href;}if(typeof h==="undefined"){h=true;}var d=["?","#"];var a,g;for(var c in d){a=d[c];var g=b.split(a);if(g.length>1){break;}}var f=g[0].replace(/(\/$)/,"");e="/"+e.replace(/((^\/)|(\/$))/g,"");if(h){if(f.indexOf(e)===f.length-e.length){e="";}}g[0]=f+e;return g.join(a);}$(function(){if(wp.clp==0){init_login_popup();}if(wp.fb_req==1&&wp.auth!=1){$("a.ap_signin").click(function(a){return show_old_facebook_login(null,i18n.T("systemjs_login_required"),wp.login_popup_title,wp.login_popup_desc);});$("a.ap_account_link").click(function(){return show_old_facebook_login("/account/",i18n.T("systemjs_login_required"),wp.login_popup_title,wp.login_popup_desc);});}});