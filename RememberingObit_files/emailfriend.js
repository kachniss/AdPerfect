var mod_emailfriend={active_id:null,send_ajax:null,init:function(){mod_emailfriend.send_ajax=true;mod_emailfriend.active_id=mod.ef.active_id;},register_handlers:function(){$("body").on("click",".ap_emailfriend_link",function(){var a=$(this).attr("data-id");mod_emailfriend.active_id=a;});$(".ap-email-friend-icon").click(function(){if(!mod_emailfriend.send_ajax){return;}var a=$(this).data("svc");mod_emailfriend.dispatch_email(a);});},dispatch_email:function(a){var e=mod.ef.mod_form;var c=mod.ef.id_key;var b=mod_emailfriend.active_id;var d={service:a};d[c]=b;d[e]="";mod_emailfriend.send_ajax=false;$.ajax({dataType:"json",url:"/ajax/post_form/",data:d,type:"POST",success:function(f){if(f&&f.type==="ap_success"&&$.trim(f.message)!==""){var g=$('<a target="_blank" />').appendTo($("#email-friend-form"));g.attr("href",f.message);g[0].click();}},complete:function(){mod_emailfriend.send_ajax=true;}});}};$(function(){mod_emailfriend.init();mod_emailfriend.register_handlers();});