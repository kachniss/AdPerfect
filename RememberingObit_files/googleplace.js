var mod_googleplace={_autocomplete:{},_geocoder:{},_autocomplete_service:null,_is_initialized:false,_function_queue:[],_init:function(){if(typeof mod.googleplace!=="undefined"){$.each(mod.googleplace.settings,function(b,a){mod_googleplace.add_to_autocomplete(b,a);});mod_googleplace._geocoder=new google.maps.Geocoder();mod_googleplace._register_handlers();mod_googleplace._is_initialized=true;}},reinit:function(b,a){a=a||mod.googleplace.settings[b];mod_googleplace.add_to_autocomplete(b,a);},handle_reinit:function(b,a){mod.googleplace.settings[b]=a;if(typeof mod.googleplace!=="undefined"){mod_googleplace.add_to_autocomplete(b,a);mod_googleplace._geocoder=new google.maps.Geocoder();mod_googleplace.reregister_handlers(b);}},add_to_autocomplete:function(d,c){var b=$("#"+d)[0];var a=$("#"+c.geocode);mod_googleplace._autocomplete[d]={map:new google.maps.places.Autocomplete(b,mod_googleplace._format_params(c)),elem:b,last_selected_input:"",last_result:{},geocode_elem:a,initial_geocode:a.val(),initial_place:b.value};},_format_params:function(b){var a={};$.each(b,function(c,d){switch(c){case"countryrestriction":if(d){a.componentRestrictions={country:d};}break;case"types":a.types=d;break;}});return a;},_register_handlers:function(){$.each(mod_googleplace._autocomplete,function(b,a){google.maps.event.addListener(a.map,"place_changed",function(){mod_googleplace._place_changed_handler.call(this,b);});});},reregister_handlers:function(b){if(mod_googleplace._autocomplete[b]!=="undefined"){var a=mod_googleplace._autocomplete[b];google.maps.event.addListener(a.map,"place_changed",function(){mod_googleplace._place_changed_handler.call(this,b);});}},_place_changed_handler:function(b){var a=mod_googleplace._autocomplete[b];a.last_selected_input=$(a.elem).val();a.last_result=this.getPlace();mod_googleplace.update_geocode_input(b);},_is_result_available:function(c){if(!(c in mod_googleplace._autocomplete)){return false;}var b=mod_googleplace._autocomplete[c];var a=$.trim($(b.elem).val()).toLowerCase();if(a===""||a!==$.trim(b.last_selected_input).toLowerCase()){return false;}return true;},_add_to_function_queue:function(a,b,c){mod_googleplace._function_queue.push({context:a,fn:b,params:c});},_run_queue:function(){$.each(mod_googleplace._function_queue,function(a,b){b.fn.apply(b.context,b.params);});},add_listener:function(d,b,a){if(!mod_googleplace._is_initialized){mod_googleplace._add_to_function_queue(this,mod_googleplace.add_listener,arguments);return;}if(!(d in mod_googleplace._autocomplete)||typeof a!=="function"){return;}var c=mod_googleplace._autocomplete[d].map;google.maps.event.addListener(c,b,a);},get_place:function(a){if(!mod_googleplace._is_result_available(a)){return null;}return mod_googleplace._autocomplete[a].last_result;},get_last_selected_input:function(a){if(!(a in mod_googleplace._autocomplete)){return;}return mod_googleplace._autocomplete[a].last_selected_input;},get_initial_place:function(a){if(!(a in mod_googleplace._autocomplete)){return;}return $.trim(mod_googleplace._autocomplete[a].initial_place);},get_initial_geocode:function(a){if(!(a in mod_googleplace._autocomplete)){return"";}return $.trim(mod_googleplace._autocomplete[a].initial_geocode);},get_geocode:function(d){if(!mod_googleplace._is_result_available(d)){return null;}var b=mod_googleplace._autocomplete[d].last_result;var a=mod_googleplace._autocomplete[d].initial_geocode;if($.trim(b.name)===$.trim(mod_googleplace._autocomplete[d].initial_place)&&typeof a!=="undefined"){var c=a.split(",");return{lat:c[0],lng:c[1]};}if(!b.geometry){return null;}return{lat:b.geometry.location.lat(),lng:b.geometry.location.lng()};},get_address_component:function(c){if(!mod_googleplace._is_result_available(c)){return null;}var a=mod_googleplace._autocomplete[c].last_result;var b=mod_googleplace.format_address_component(a);if(b===null){return null;}return b;},format_address_component:function(d){if(!d.geometry){return null;}var b=d.address_components;var c={};var a={};$.each(b,function(e,f){switch(f.types[0]){case"street_number":a.street_number=f.long_name;break;case"route":a.route=f.long_name;break;case"locality":c.locality=f.long_name;break;case"administrative_area_level_3":c.administrative_area=f.long_name;break;case"colloquial_area":c.colloquial_area=f.long_name;case"administrative_area_level_1":a.state=f.long_name;a.state_short=f.short_name;break;case"country":a.country=f.long_name;a.country_short=f.short_name;break;case"postal_code":a.postal_code=f.long_name;break;case"neighborhood":a.village=f.long_name;break;default:break;}});a.city=c.locality||c.administrative_area||c.colloquial_area||null;return a;},update_geocode_input:function(e){var c=mod_googleplace._autocomplete[e];var a=c.geocode_elem;if(!$.isEmptyObject(a)){var b=mod_googleplace.get_geocode(e);if(b!==null){var d=b.lat+","+b.lng;a.val(d);}else{a.val("");}}},format_google_place:function(d){if(!d||!d.geometry){return null;}var b=mod_googleplace.format_address_component(d);var c={lat:d.geometry.location.lat(),lng:d.geometry.location.lng()};var a={address_components:b,geocode:c,name:d.formatted_address};return a;},run_geocoder:function(f,b,e){var c=mod_googleplace._format_params(mod.googleplace.settings[f]);delete (c.types);var a={address:b};var d=$.extend(c,a);mod_googleplace._geocoder.geocode(d,function(h,g){if(g==google.maps.GeocoderStatus.OK){if(h[0]){var i=mod_googleplace.format_google_place(h[0]);e(i);}}else{e(null);}});},predict_place:function(f,d,e){if(mod_googleplace._autocomplete_service===null){mod_googleplace._autocomplete_service=new google.maps.places.AutocompleteService();}var b=mod_googleplace._format_params(mod.googleplace.settings[f]);var a={input:d};var c=$.extend(b,a);mod_googleplace._autocomplete_service.getPlacePredictions(c,function(i,h){if(i==null||h!==google.maps.places.PlacesServiceStatus.OK){e(null);return;}var j=i[0];var g=j.place_id;if(!g){e(null);return;}mod_googleplace._geocoder.geocode({placeId:g},function(l,k){if(l==null||k!==google.maps.GeocoderStatus.OK){e(null);return;}var m=mod_googleplace.format_google_place(l[0]);e(m);});});},clear_values:function(a){if(!(a in mod_googleplace._autocomplete)){return;}$("#"+a).val("");mod_googleplace._autocomplete[a].geocode_elem.val("");mod_googleplace.last_selected_input="";mod_googleplace.last_result={};}};$(document).ready(function(){mod_googleplace._init();mod_googleplace._run_queue();});